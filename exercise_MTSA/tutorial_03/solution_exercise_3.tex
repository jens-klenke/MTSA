\documentclass[12pt,a4paper]{article}
\usepackage{lmodern}

\usepackage{placeins}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{€}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[lmargin = 2cm, rmargin = 2.5cm, tmargin = 2cm, bmargin = 2.5cm]{geometry}


% Figure Placement:
\usepackage{float}
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
    \expandafter\origfigure\expandafter[H]
} {
    \endorigfigure
}

%%%% Jens %%%%
\usepackage{titlesec}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\renewcommand{\vec}{\operatorname{vec}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\diag}{\operatorname{diag}}

\allowdisplaybreaks

\titleformat{\section}
{\normalfont\large\bfseries}{\thesection}{1em}{}

\newcommand{\tmpsection}[1]{}
\let\tmpsection=\section
\renewcommand{\section}[1]{\tmpsection{\underline{#1}} }





%% citation setup
\usepackage{csquotes}

\usepackage[backend=biber, maxbibnames = 99, style = apa]{biblatex}
\setlength\bibitemsep{1.5\itemsep}
\addbibresource{R_packages.bib}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true, linktocpage = TRUE]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Dr.~Yannick Hoga},
            pdftitle={Multivariate Time Series Analysis},
            colorlinks=true,
            citecolor=black,
            urlcolor=black,
            linkcolor=black,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{5}

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{Multivariate Time Series Analysis}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
\subtitle{Solution Exercise Sheet 3}
  \author{Dr.~Yannick Hoga}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \date{}
  \predate{}\postdate{}


%% linespread settings

\usepackage{setspace}

\onehalfspacing


% Language Setup

\usepackage{ifthen}
\usepackage{iflang}
\usepackage[super]{nth}
\usepackage[ngerman, english]{babel}

%Acronyms
\usepackage[printonlyused, withpage, nohyperlinks]{acronym}
\usepackage{changepage}

% Multicols for the Title page
\usepackage{multicol}


% foot


\begin{document}

\selectlanguage{english}

%%%%%%%%%%%%%% Jens %%%%%
\numberwithin{equation}{section}




\restoregeometry


%%% Header 

\begin{minipage}{0.6\textwidth}
University of Duisburg-Essen\\
Faculty of Business Administration and Economics\\
Chair of Econometrics\\
\end{minipage}

%\begin{minipage}{0.4\textwidth}
	\begin{flushright}
	\vspace{-3cm}
	\includegraphics*[width=5cm]{Includes/duelogo_en.png}\\
	\vspace{.125cm}
	\end{flushright}
%\end{minipage}
%\vspace{.125cm}
\hspace{-0.005cm}Winter Term 2019/2020

\vspace{0.05cm}

\begin{center}
	\vspace{.25cm}
	Dr.~Yannick Hoga \hspace{.5cm} Thilo Reinschlüssel \\
	\vspace{.25cm}
	\textbf{\Large{Multivariate Time Series Analysis}}\\
	\vspace{.25cm}
	\textbf{\large{Solution Exercise Sheet 3}}\\
	\vspace{.125cm}
\end{center}




% body from markdown

\hypertarget{exercise-1-var1-moments-and-stationarity}{%
\section{Exercise 1: VAR(1) Moments and
Stationarity}\label{exercise-1-var1-moments-and-stationarity}}

Take the VAR(1) model \(z_t = \phi_0 + \phi_1 z_{t-1} + a_t\) with the
following parameterisation:

\begin{align*}
    \phi_0 = \begin{pmatrix} 1 \\ 0 \end{pmatrix}, \quad \phi_1 = \begin{pmatrix} 0.75 & 0 \\ -0.25 & 0.5 \end{pmatrix}, \quad \Sigma_a = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}
\end{align*}

\begin{itemize}
    \item[a)] Compute the mean of the process.
\end{itemize}

\emph{Solution:}

\begin{align*}
  \underset{\Rightarrow}{E(\cdot)} \quad \underbrace{ \mathbb{E} (z_t)}_{\mu} & = \mathbb{E} \left(  \underbrace{\phi_0}_{\phi_0} + \underbrace{\phi_1 z_{t -1}}_{\phi_1 \cdot \mu}+ \underbrace{a_t}_{0}\right)\\
  \left[ \text{Key assumption?} \;  \mathbb{E} (z_t)  = \mathbb{E} (z_{t-1}) \right]\\
  \Leftrightarrow \left( I - \phi_1 \right) \cdot \mu & = \phi_0\\
  \Leftrightarrow \mu & = \left( I - \phi_1 \right)^{-1} \cdot \phi_0\\
  \text{plugging in} \ \phi_1 \text{and} \ \phi_0:\\
  \mu & = \begin{pmatrix} 
  0.25 & 0 \\
  0.25 & 0.5
  \end{pmatrix}^{-1} 
  \begin{pmatrix} 
  1 \\
  0
  \end{pmatrix}\\
  & = 
  \begin{pmatrix} 
  -4 \\
  2
  \end{pmatrix}\\
\end{align*}

\begin{itemize}
    \item[b)] Show that the process is stationary.
\end{itemize}

\emph{Solution:}

Eigenvalues of \(\phi_1:\)

\begin{align*}
  \left| \phi_1 - I \lambda \right| & \overset{!}{=} 0 \\
  & = \begin{vmatrix}
  0.75 - \lambda & 0 \\
  -0.25 & 0.5 - \lambda 
  \end{vmatrix}\\
  & = (0.75 - \lambda)(0.5 - \lambda) \overset{!}{=}  0 \\
  \Rightarrow \lambda_1 & = 0.75 \\
  \lambda_2 & = 0.5\\
\end{align*}

Both Eigenvalues are inside the unit circle therefore the process is
stationary.

\begin{itemize}
    \item[c)] Derive the Yule-Walker equations for the lage $l = \{0,1,2 \}$ and show that the solution for $\Gamma_0$ coincides with equation (2.3) on slide 2-15.
\end{itemize}

\begin{align*}
  \tilde{z}_t & := z_t - \mu \\
  \Rightarrow \tilde{z}_t & =  \phi_1 \tilde{z}_{t-1} + a_t \qquad & | \cdot \tilde{z}_{t-1}^{'}   \\
  \Leftrightarrow \tilde{z}_t \tilde{z}_t^{'} & = \phi_1 \tilde{z}_t \tilde{z}_t^{'} + a_t \tilde{z}_t^{'}\\
  \overset{\mathbb{E} (\cdot)}{\Rightarrow} \Gamma_l & = \phi_1 \cdot \Gamma_{l- 1} + \begin{cases} 
  l & = 0: \Sigma_a \\
  l & \neq 0: 0_k\\
  \end{cases}\\
  l & = 0: \Gamma_0 = \phi_1 \cdot \Gamma_{-1} + \Sigma_a\\
  l & = 1: \Gamma_1 = \phi_1 \cdot \Gamma_{0} + 0_K \\
  l & = 2: \Gamma_2 = \phi_1 \cdot \Gamma_{1} + 0_K \\
  \text{using} \ \Gamma_{-1} & = \Gamma_{1}^{'}\\ 
  \Gamma_0 & = \phi_1 \cdot \left( \phi_1 \Gamma_0 \right)^{'} + \Sigma_a\\
  \Leftrightarrow \Gamma_0 & = \phi_1 \Gamma_0^{'} \phi_1^{'}  + \Sigma_a\\
   \text{and} \ \Gamma_0^{'} & = \Gamma_0 \ \text{since}  \ \Gamma_0 \ \text{is symmetric !}
\end{align*}

\begin{itemize}
    \item[d)] Compute $\Gamma_0$ and $\Gamma_1$ by hand based on your results from c).
\end{itemize}

\begin{align*}
  \begin{pmatrix} 
  \gamma_{11} & \gamma_{12}\\
  \gamma_{21} & \gamma_{22}
  \end{pmatrix} & =
  \begin{pmatrix} 
  \gamma_{11} & \gamma_{12}\\
  \gamma_{12} & \gamma_{22}
  \end{pmatrix}\\ 
\end{align*}

\begin{align*}
  & =
  \begin{pmatrix} 
  0.75 & 0\\
  -0.25 & 0.5
  \end{pmatrix} 
  \begin{pmatrix} 
  \gamma_{11} & \gamma_{12}\\
  \gamma_{12} & \gamma_{22}
  \end{pmatrix}
  \begin{pmatrix} 
  0.75 & -0.25\\
  0 & 0.5
  \end{pmatrix} +
  \begin{pmatrix} 
  1 & 0\\
  0 & 1
  \end{pmatrix}\\
  & = 
  \begin{pmatrix}
  (0.75)^2 \gamma_{11} & (-0.75 \cdot 0.25 \gamma_{11}) + 0.5 \cdot 0.75 \gamma_{12} \\
  (0.75 \cdot 0.25 \gamma_{11}) + 0.5 \cdot 0.75 \gamma_{12} & (-0.25)^2 \gamma_{11} - 0.25 \cdot 0.5 \gamma_{12} - 0.5 \cdot 0.25 \gamma_{12} + (0.5)^2 \gamma_{22}
  \end{pmatrix} +
  \begin{pmatrix}
  1 & 0\\
  0 & 1
  \end{pmatrix}
  \end{align*}

\begin{align*}
  \Rightarrow \gamma_{11} & = (0.75)^2 \gamma_{11} + 1\\
  \Leftrightarrow \gamma_{11} & = \dfrac{16}{7}\\
  \Rightarrow \gamma_{12} & = \dfrac{1}{4} \cdot \left( - \dfrac{3}{4} \right) \cdot \dfrac{16}{7} + \dfrac{2}{4} \cdot \dfrac{3}{4} \gamma_{12} \\
  \Leftrightarrow \gamma_{12} & = - \dfrac{24}{35}\\
  \Rightarrow \gamma_{22} & = \dfrac{1}{16} \gamma_{11} - 2 \cdot \dfrac{1}{2} \cdot \dfrac{1}{4} \gamma_{12} + \dfrac{1}{4} \gamma_{22} + 1 \\
  & =  \dfrac{1}{16} \cdot \dfrac{16}{7} - 2 \cdot \dfrac{1}{2} \cdot \dfrac{1}{4} \left(- \dfrac{24}{35} \right) + \dfrac{1}{4} \gamma_{22} + 1\\
  \gamma_{22} & = \dfrac{184}{105}\\
  \\
  \Gamma_1 & = \phi_1 \cdot \Gamma_0\\
  & = 
  \begin{pmatrix} 
  0.75 & 0 \\
  -0.25 & 0.5
  \end{pmatrix}
  \cdot 
  \begin{pmatrix} 
  \frac{16}{7} & \frac{-24}{35}\\
  \frac{-24}{35} & \frac{184}{105}
  \end{pmatrix}
\end{align*}

\hypertarget{exercise-2-stationarity-of-varp-processes}{%
\section{Exercise 2: Stationarity of VAR(p)
Processes}\label{exercise-2-stationarity-of-varp-processes}}

Using the notation of Slide 2-27, prove that
\(|I_{kp} - \pmb{\Phi_1} z| = |I_k - \phi_1 z - \ldots - \phi_p z^p|\).
Recall that \(|A|\) denotes the determinant od the matrix \(A\)

\emph{Hint: Derive} \(\pmb{\Phi}_1\) \emph{and keep it mind that adding
multiplies of columns/rows to other columns/rows does not affect the
determinate! The plan is to end up with a special matrix.}

\emph{Solution:}

\begin{align*}
  z_t = & \phi_0  + \phi_1 z_{t-1} + \ldots + \phi_p z_{t - p} + a_t\\
  \text{as VAR (1):} & Z_t = \begin{pmatrix} \phi_0 \\ 
  0\\
  \vdots \\
  \end{pmatrix} + 
  \Phi_1 Z_{t - 1} +
  \begin{pmatrix} 
  a_t \\  
  0\\
  \vdots 
  \end{pmatrix}\\
  \text{with} & Z_t =   
  \begin{pmatrix} 
   z_t \\
   z_{t-1} \\
   \vdots \\
   z_{t-p+1}
  \end{pmatrix}
  \text{and} \ Z_{t-1} = 
  \begin{pmatrix} 
   z_t \\
   z_{t-1} \\
   \vdots \\
   z_{t-p+1}
  \end{pmatrix}\\
  \Phi_1 = &
  \begin{pmatrix}
  \phi_1 & \phi_2 & \ldots  & \ldots & \phi_p \\
  I_K & 0_K & \ldots & \ldots & 0_k\\
  0_K & I_K & 0_k & \ldots & 0_k\\
  \vdots & \ddots & \ddots &  & \vdots\\
  0_k & \ldots &  0_k & I_k & 0_k
  \end{pmatrix}
\end{align*}

\(\Rightarrow\) Now one can apply the formulas for a VAR(1) to check
stationarity.

\begin{align*}
\left| \Phi_1 - \lambda I \right| & \overset{!}{=} 0 \\
\Leftrightarrow (-1)^k \left| \Phi_1 - \lambda I \right| & \overset{!}{=} 0 \\
\Leftrightarrow \left| \lambda \left( I -  \Phi_1 \dfrac{1}{\lambda} \right)  \right| & \overset{!}{=} 0 \quad &  \text{since} \ \lambda \ \text{is a scalar} \ I = I_{kp} \\ 
\Leftrightarrow  \lambda^{kp} \left| I - \Phi_{1} \dfrac{1}{\lambda} \right|  & \overset{!}{=} 0 \quad & \text{and let} \dfrac{1}{\lambda} =: z \\
\Rightarrow \left| I - \Phi_1 z \right| & \overset{!}{=} 0 
\end{align*}

\(\Rightarrow\) Stationarity if all \(|z_i| > 1 (|\lambda_i| < 1)\)

\begin{align*}
  I_{kp} - \Phi_1 z & = 
  \begin{pmatrix}
    I_k - \phi_1 z & - \phi_2 z & - \phi_3 z & \ldots & - \phi_{p - 1} z & - \phi_{p} z \\
    - I_k z        & I_k        &  0_k       & \ldots & 0_k & 0_k \\
    0_k   & - I_k z        & I_k & \ldots & 0_k & \vdots\\
    \vdots & 0_k   & - I_k z        & \ldots & \vdots & \vdots \\
    0_k & 0_k & 0_k & \ldots &  - I_k z        & I_k
  \end{pmatrix}
\end{align*}

\(\Rightarrow -I_k \cdot z + I_k \cdot z = 0_k\)

Since adding multiplies of columns to other columns does not affect the
determinant:\\

\(\Rightarrow\) column \enquote{i} \(\cdot z\) + column \enquote{i - 1}
\(\forall i \in \left\{ p, \ldots, 2\right\}\) yields a traingluar
matrix

\begin{align*}
  \Rightarrow
  \begin{pmatrix}
    I_k - \phi_1 z & - \phi_2 z^2 & \ldots & - \phi_{p} z & -\phi_1 & -\phi_2 z - \ldots -\phi_p z^{p-1}  \\
    & 0_k & & & I_k & &\\
    & 0_k & & & & I_k &\\
  \end{pmatrix}
\end{align*}

\begin{align*}
  \Rightarrow \left| I_{kp} - \Phi_1 z \right| & = \left( I_K - \phi_1 z - \ldots - \phi_p z^p \right) \cdot \prod_{i = 1}^{p-1} I_k & \text{since it is a triangular matrix}\\
  & = \left| I_k - \phi_1 z - \ldots - \phi_p z^p \right| 
\end{align*}

\hypertarget{exercise-3-var2-moments-and-stationarity}{%
\section{Exercise 3: VAR(2) Moments and
Stationarity}\label{exercise-3-var2-moments-and-stationarity}}

Consider the following VAR(2) model with i.i.d. innovations:

\begin{align*}
    \phi_0 = \begin{pmatrix} 2 \\ 1 \end{pmatrix}, \quad \phi_1 = \begin{pmatrix} 0.5 & 0.1 \\ 0.4 & 0.5 \end{pmatrix}, \quad \phi_2 = \begin{pmatrix} 0 & 0 \\ 0.25 & 0 \end{pmatrix}, \quad \Sigma_a = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}
\end{align*}

\begin{itemize}
    \item[a)] Show that the process is stationary.
\end{itemize}

\emph{Solution:}

\begin{align*}
  \left| I_2 - \phi_1 z - \phi_2 z^2 \right| & \overset{!}{=} 0 \\
  \Rightarrow \begin{pmatrix} 1 & 0 \\ 
  0 & 1 \end{pmatrix} - \begin{pmatrix}  0.5 z & 0.1 z \\
  0.4 z & 0.5 z
  \end{pmatrix} - 
  \begin{pmatrix}  0 & 0 \\
  0.25 z & 0
  \end{pmatrix} & \overset{!}{=} 0\\
  \Leftrightarrow
  \left|
    \begin{pmatrix}  1- 0.5 z & -0.1 z \\
      -0.4 z - 0.25z^2 & 1- 0.5z
  \end{pmatrix}
  \right| & \overset{!}{=} 0\\
  = (1 - 0.5 z)^2 - (0.4z + 0.25z^2) \cdot 0.1z  & \overset{!}{=} 0 \\
  = 1 - z + 0.21 z^2 -0.025 z^3 & \overset{!}{=} 0
\end{align*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{roots <-}\StringTok{ }\KeywordTok{polyroot}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{-1}\NormalTok{, }\FloatTok{0.21}\NormalTok{, }\FloatTok{0.025}\NormalTok{))}
\NormalTok{roots }\CommentTok{# there are some imaginary parts attached to it}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]   1.804197+0.27546i   1.804197-0.27546i -12.008393+0.00000i
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sum}\NormalTok{(}\KeywordTok{abs}\NormalTok{(roots) }\OperatorTok{<}\StringTok{ }\DecValTok{1}\NormalTok{) }\CommentTok{# count how many roots lie inside the unit circle}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0
\end{verbatim}

Since all roots are outside the unit circle the process ist stationary.

Alternativetly, we could also use the VAR(1) approach and compute the
eigenvalues.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{phi_}\DecValTok{1}\NormalTok{ <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.4}\NormalTok{, }\FloatTok{0.1}\NormalTok{, }\FloatTok{0.5}\NormalTok{), }\DataTypeTok{nrow =} \DecValTok{2}\NormalTok{)}
\NormalTok{phi_}\DecValTok{2}\NormalTok{ <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{), }\DataTypeTok{nrow =} \DecValTok{2}\NormalTok{)}
\NormalTok{I2x2 <-}\StringTok{ }\KeywordTok{diag}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\NormalTok{O2x2 <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{data =} \KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{4}\NormalTok{), }\DataTypeTok{nrow =} \DecValTok{2}\NormalTok{)}
\NormalTok{Phi <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{( }\KeywordTok{cbind}\NormalTok{(phi_}\DecValTok{1}\NormalTok{, phi_}\DecValTok{2}\NormalTok{), }\KeywordTok{cbind}\NormalTok{(I2x2, O2x2) )}
\NormalTok{Phi}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4]
## [1,]  0.5  0.1 0.00    0
## [2,]  0.4  0.5 0.25    0
## [3,]  1.0  0.0 0.00    0
## [4,]  0.0  1.0 0.00    0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{var1.eigen <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Phi)}
\KeywordTok{sum}\NormalTok{(}\KeywordTok{abs}\NormalTok{(var1.eigen}\OperatorTok{$}\NormalTok{values) }\OperatorTok{<}\StringTok{ }\DecValTok{1}\NormalTok{) }\CommentTok{# How many eigenvalues lie inside the unit circle?}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4
\end{verbatim}

All 4 eigenvalues lie inside the unit circle and we get the same
results.

\begin{itemize}
    \item[b)] Determine the mean vector.
\end{itemize}

\begin{align*}
  z_t & = \phi_0 + \phi_1 z_{t-1} + \phi_2 z_{t-2} +a_t\\
  \overset{E(\cdot)}{\Rightarrow} \ldots  \Rightarrow \mu & = \left( I - \phi_1 - \phi_2 \right)^{-1} \phi_0 \\  
  & = \begin{pmatrix}
  1 - 0.5 &  -0.1\\
  -0.4 - 0.25 & 1 - 0.5
  \end{pmatrix}^{-1}
   \begin{pmatrix}
  2\\
  1
  \end{pmatrix}
\end{align*}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{phi_}\DecValTok{0}\NormalTok{ <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{)}
\NormalTok{mu <-}\StringTok{ }\KeywordTok{solve}\NormalTok{((I2x2 }\OperatorTok{-}\StringTok{ }\NormalTok{phi_}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{phi_}\DecValTok{2}\NormalTok{)) }\OperatorTok{%*%}\StringTok{ }\NormalTok{phi_}\DecValTok{0}
\KeywordTok{fractions}\NormalTok{(mu)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]  
## [1,] 220/37
## [2,] 360/37
\end{verbatim}

\begin{itemize}
    \item[c)] Derive the Yule-Walker equations for the lage $l = \{0,1,2 \}$ for a general VAR(2) process.
\end{itemize}

\begin{align*}
  \mathbb{E} \left( \tilde{z}_{t} \tilde{z}_{t-l}^{'} \right) & =  \phi_1 \mathbb{E} \left( \tilde{z}_{t} \tilde{z}_{t-l}^{'} \right) + \phi_2 \mathbb{E} \left( \tilde{z}_{t} \tilde{z}_{t-l}^{'} \right) + \mathbb{E} \left( a_{t} \tilde{z}_{t-l}^{'} \right)\\
  \\
  \Rightarrow l & = 0: \Gamma_0 = \phi_1 \Gamma_{-1} + \phi_2 \Gamma_{-2} + \Sigma_a \\
  l & = 1: \Gamma_1 = \phi_1 \Gamma_{0} + \phi_2 \Gamma_{-1} + 0_{2 \times 2}\\
  l & = 2: \Gamma_1 = \phi_1 \Gamma_{1} + \phi_2 \Gamma_{0} + 0_{2 \times 2}
\end{align*}

\begin{itemize}
    \item[d)] Suppose we only knew $\Gamma_0 , \Gamma_1$ and $\Gamma_2$ - how can we estimate $\phi_1$ and $\phi_2$ from it?
\end{itemize}

\begin{align*}
  \overbrace{\begin{pmatrix} \Gamma_1 & \Gamma_2 \end{pmatrix}}^{\text{row vector}} & = \begin{pmatrix} \phi_1 & \phi_2 \end{pmatrix} \begin{pmatrix} \Gamma_0 & \Gamma_1\\
  \Gamma_1^{'} & \Gamma_0 \end{pmatrix}\\
  \Rightarrow \begin{pmatrix} \phi_1 & \phi_2 \end{pmatrix} & = \begin{pmatrix} \phi_1 & \phi_2 \end{pmatrix}^{-1} \begin{pmatrix} \Gamma_1 & \Gamma_2 \end{pmatrix} 
\end{align*}

\begin{itemize}
    \item[e)] Write the process as a VAR(1) and calculate the mean vector again.
\end{itemize}

\begin{align*}
  Z_t = \begin{pmatrix}  z_{t} \\ z_{t-1} \end{pmatrix}\\
  \\
  \begin{pmatrix} z_t  \\ z_{t-1} \end{pmatrix} & = \begin{pmatrix} \phi_0  \\ 0_{2 \times 1 }\end{pmatrix} + \begin{pmatrix} \phi_1 & \phi_2  \\ I_{2 \times 2}  & 0_{2 \times 2} \end{pmatrix} \begin{pmatrix} z_{t-1}  \\ z_{t-2} \end{pmatrix} + \begin{pmatrix} a_t  \\ 0_{2 \times 1} \end{pmatrix} \\
  \overset{\mathbb{E} (\cdot)}{\Rightarrow} \begin{pmatrix} \mu  \\ \mu \end{pmatrix} & =\begin{pmatrix} \phi_0  \\ 0_{2 \times 1} \end{pmatrix} + \begin{pmatrix} \phi_1 & \phi_2 \\ I_{2 \times 2} & 0_{2 \times 2} \end{pmatrix} \begin{pmatrix} \mu  \\ \mu \end{pmatrix} + \begin{pmatrix} 0_{2 \times 2} \\ 0_{2 \times 2} \end{pmatrix}\\
  \begin{pmatrix} \mu  \\ \mu \end{pmatrix} & = \left[  \begin{pmatrix} I_{2 \times 2} & 0_{2 \times 2}\\ 0_{2 \times 2} & I_{2 \times 2} \end{pmatrix} - \begin{pmatrix} \phi_1 & \phi_2 \\ I_{2 \times 2} & 0_{2 \times 2} \end{pmatrix} \right]^{-1} \begin{pmatrix} \phi_0 \\ 0_{2 \times 2} \end{pmatrix} \\
  & = \begin{pmatrix} 
  1-0.5 & -0.1 & 0 & 0 \\
  -0.4 & 1-0.5 & -0.25 & 0 \\
  -1 & 0 & 1 & 0 \\
  0 & -1 & 0 & 1 
  \end{pmatrix}^{-1}
  \begin{pmatrix} 
  2 \\ 1 \\ 0 \\ 0 
  \end{pmatrix}
\end{align*}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Alternative solution to b) using the VAR(1) representation:}
\NormalTok{mu2 <-}\StringTok{ }\KeywordTok{solve}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\DecValTok{4}\NormalTok{) }\OperatorTok{-}\StringTok{ }\NormalTok{Phi) }\OperatorTok{%*%}\StringTok{ }\KeywordTok{c}\NormalTok{(phi_}\DecValTok{0}\NormalTok{, }\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\KeywordTok{fractions}\NormalTok{(mu2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]  
## [1,] 220/37
## [2,] 360/37
## [3,] 220/37
## [4,] 360/37
\end{verbatim}

\begin{itemize}
    \item[f)] Compute $\Gamma_0$ based on the VAR(1) formulation.
    \item[] \textit{Hint: You can use R for the calculations.}
\end{itemize}

\begin{align*}
  \Gamma_0 & = \Phi \Gamma_0 \Phi + \Sigma_b \\
  \\
  \text{with} & \Phi = \begin{pmatrix} \phi_1 & \phi_2 \\
  I_{2 \times 2} & 0_{2 \times 2}
  \end{pmatrix}
  \end{align*}

\begin{align*}
  \text{and} \ \tilde{Z}_t \tilde{Z}_t & = \begin{pmatrix} \tilde{z}_t \\ \tilde{z}_{t -1} \end{pmatrix}   \begin{pmatrix} \tilde{z}_t & \tilde{z}_{t -1} \end{pmatrix} \\
  & =  \begin{pmatrix} \tilde{z}_t \tilde{z}_t^{'} & \tilde{z}_t \tilde{z}_{t -1}^{'} \\
   \tilde{z}_{t -1} \tilde{z}_t^{'} & \tilde{z}_{t -1} \tilde{z}_{t -1}^{'} \end{pmatrix} \\
   & = \underbrace{\begin{pmatrix} \Gamma_0 & \Gamma_1 \\ \Gamma_1^{'} & \Gamma_0 \end{pmatrix}}_{=: \Gamma_0^{*}}\\
   \\
   \text{gives:} & \left( I_{4 \times 4} - \Phi \otimes \Phi  \right) \ \vec(\Gamma_0^{*}) = \ \vec(\Sigma_b)\\
   \Leftrightarrow \vec(\Gamma_0^{*}) & = \left( I_{4 \times 4} - \Phi \otimes \Phi  \right)^{-1}  \ \vec(\Sigma_b)
\end{align*}

\(\Rightarrow\) extract top left or bootom right matrix

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Sigma_a <-}\StringTok{ }\KeywordTok{diag}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\NormalTok{Sigma_b <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{( }\KeywordTok{cbind}\NormalTok{(Sigma_a, O2x2), }\KeywordTok{cbind}\NormalTok{(O2x2, O2x2) )}
\NormalTok{Gamma0ast.mat <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{solve}\NormalTok{(}\KeywordTok{diag}\NormalTok{(}\DecValTok{16}\NormalTok{) }\OperatorTok{-}\StringTok{ }\NormalTok{Phi }\OperatorTok{%x%}\StringTok{ }\NormalTok{Phi) }\OperatorTok{%*%}\StringTok{ }\KeywordTok{as.vector}\NormalTok{(Sigma_b) , }\DataTypeTok{nrow =} \DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{document}
