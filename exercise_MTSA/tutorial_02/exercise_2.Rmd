---
title: 'Multivariate Time Series Analysis'
author: 'Dr. Yannick Hoga'
author2: 'Thilo Reinschl√ºssel'
subtitle: 'Exercise Sheet 2'
semester: "Winter Term 2019/2020"
output:
  pdf_document:
    keep_tex: yes
    template: ../template.tex
    fig_caption: yes
    citation_package: biblatex
    number_sections: true
toc: true
lot: true
lof: true
graphics: true
linkcolor: black
urlcolor: black
citecolor: black
colorlinks: true
font: Times New Roman
fontsize: 12pt
geometry: lmargin = 2cm, rmargin = 2.5cm, tmargin = 2cm, bmargin = 2.5cm
classoption: a4paper
---

```{r , include=FALSE}
Sys.setlocale(locale = "English_United States.1252") ## English US Windows
knitr::opts_chunk$set(echo = TRUE)

#options(kableExtra.latex.load_packages = FALSE)
#### required packages ####
source(here::here("packages/packages.R"))
```

# Exercise 1: Moments and Simulation of a VAR(1) Process

Take the model from Example 2.4 on Slide 2-6:

\begin{itemize}
  \item[a)] Derive a formula to obtain the population cross-covariance matrices for the lags 1 to 10 and compute them using R
  \begin{align*}
    z_t & = \phi_1 z_{t-1} + a_t\\
    \\
    \Gamma_0 & = \phi_1  \ \Gamma_0 \ \phi_1^{'} + \Sigma_a\\
    \Leftrightarrow \vec(\Gamma_0) &= (\phi_1 \otimes \phi_1) \cdot \vec(\Gamma_0) + \vec(\Sigma_a) \\
    \Leftrightarrow \vec(\Gamma_0) &= (I_{K^2} - \phi_1 \otimes \phi_1) \cdot \vec(\Sigma_a) \\
   \Rrightarrow \Gamma_1 & = \phi_1 \Gamma_0\\
   \Rrightarrow \Gamma_l & = \phi_{l-1} \Gamma_{l-1} = \phi_1^{l} \Gamma_0\\
  \end{align*}
\end{itemize}


```{r }
# First define parameters/coefficients:
Phi <- matrix(data = c(0.2, -0.6, 0.3, 1.1), 
              byrow = FALSE, nrow = 2) # VAR coefficients
Sigma_a <- matrix(data = c(1, 0.8, 0.8, 2.0), 
                  byrow = FALSE, nrow = 2) # innovations' covariances

Phi_kron <- kronecker(X = Phi, Y = Phi) # kronecker product
# Phi %x% Phi # alternative command

Ident <- diag(ncol(Phi)^2) 
# identity matrix with the same dimensions as Phi_kron

Gamma0.vec <- solve(Ident - Phi_kron) %*% c(Sigma_a) 
# c() works like the "vec" operator

Gamma0.mat <- matrix(data = Gamma0.vec, nrow = 2, byrow = FALSE)
Gamma0.mat
```




\begin{itemize}  
  \item[] \textit{Hint: A glance at the slides and a loop might save you some time}
  \item[b)] Based on your results, compute the cross-correlation matrices
  \item[c)] Draw a corresponding innovation sequence at for 300 periods from a (multivariate) Gaussian distribution and simulate the given VAR(1) process without any further built-in functions
  \item[] \textit{Hint: 'mvrnorm' and 'for' are still allowed}
  \item[d)] Plot the multivariate time series you have just created. Does it look stationary?
  \item[e)] Estimate the sample cross-covariance and cross-correlation matrices. Compare these with the population moment matrices from task a)
\end{itemize}

# Exercise 2: Checking VAR(1) Stationarity

Recall the conditions to check if a VAR(1) process is stationary. Now assume the VAR(1) model $z_t = \phi_1 z_{t-1} + a_t$ with $a_t$ as asequences of $i.i.d.$ innovations:

\begin{itemize}
  \item[a)] Do you need to make further assumptions on the cross-correlations of $a_t$ to ensure stationarity
  \item[b)] Which of the following processes are stationary? $\phi_1 = \ldots$
  \begin{align*}
    \text{i)} 
    \begin{pmatrix}
      0.2 & 0.3 \\
      -0.6 & 1.1
    \end{pmatrix}
    \text{ii)} 
    \begin{pmatrix}
      0.5 & 0.3 \\
      0 & -0.3
    \end{pmatrix}
    \text{iii)} 
    \begin{pmatrix}
      1 & 0 \\
      0 & 1
    \end{pmatrix}
    \text{iv)} 
    \begin{pmatrix}
      1 & -1 \\
      1 & -1
    \end{pmatrix}
    \text{v)} 
    \begin{pmatrix}
      1 & -0.5 \\
      -0.5 & 0
    \end{pmatrix}
  \end{align*}
\end{itemize}



